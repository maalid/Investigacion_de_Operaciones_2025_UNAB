---
title: "Taller 3: Método de Transporte Usando lpSolve()"
subtitle: "*Investigación de Operaciones - ADVANCE - UNAB*"
author: "Marcelo Alid-Vaccarezza"
date: "`r Sys.Date()`"
output:
  html_notebook:
    toc: true
    toc_float: true
    toc_collapsed: true
    toc_depth: 3
    fig_caption: true
    number_sections: false
    theme: cosmo
---

<div style="text-align: justify">
<br>
<br>


```{r setup, include = FALSE}
knitr::opts_chunk$set(echo = TRUE)
knitr::opts_chunk$set(warning = FALSE)
```


# **Ejercicio 1.** 
La _BETTER PRODUCTS COMPANY_ ha decidido iniciar la fabricación de cuatro nuevos productos en tres plantas que por el momento tienen exceso de capacidad de producción. Los productos requieren de un esfuerzo productivo comparable por unidad, por lo que la capacidad de producción disponible en las plantas se mide por el número de unidades de cualquier producto que se pueden fabricar por día, como se muestra en la última columna de la tabla.

<br>
<center>

![**Figura 1:** ](Figura_1_Problema_1_Taller_3_Metodo_Transporte_Usando_lpSolve.png ""){height="300px" width="500px"}

</center>
<br>

El último renglón muestra la producción diaria que se requiere para satisfacer las ventas proyectadas. Cada planta puede producir cualquiera de estos productos, excepto la planta $2$ que no puede fabricar el producto $3$. Sin embargo, el costo variable por unidad de cada producto difiere entre una planta y otra, como se muestra en elcuerpo principal de la tabla. La administración necesita tomar la decisión de cómo dividir la producción entre las plantas, y para esto, decide permitir la separación de productos, de tal manera que el mismo producto se pueda fabricar en más de una planta.

(a) Formule correctamente este problema de Transporte, definiendo las variables de decisión, la función objetivo, los nodos, los suministros, las demandas, los arcos, las capacidades y los costos.
(b) Encuentre el plan óptimo de producción de cada planta, que minimiza los costos.
(c) Interprete los resultados.

Respondemos en R

## SOLUCIÓN.
En este caso, debido a que la Capacidad disponible de produccion es mayor a nuestra tasa de produccion, nos enfrentamos a un problema de transporte que no está equilibrado. Por lo tanto, debemos equilibrarlo. Para esto, es necesario incluir un punto producto ficticio, que demande los $75$ productos de capacidad sin uso. En efecto, el problema queda formulado ahora así:

**Definición de las variables de decisión.** Sean las siguientes las variables de decisión del problema:
$$
\begin{array}{ll}
x_{11} : \text{Costo al producir en la planta 1, el podructo 1.} \\ 
x_{12} : \text{Costo al producir en la planta 1, el podructo 2.} \\  
x_{13} : \text{Costo al producir en la planta 1, el podructo 3.} \\  
x_{14} : \text{Costo al producir en la planta 1, el podructo 4.} \\
x_{15} : \text{Costo al producir en la planta 1, el podructo 5 (ficticia).} \\
x_{21} : \text{Costo al producir en la planta 2, el producto 1.} \\  
x_{22} : \text{Costo al producir en la planta 2, el producto 2.} \\  
x_{23} : \text{Costo al producir en la planta 2, el producto 3.} \\  
x_{24} : \text{Costo al producir en la planta 2, el producto 4.} \\ 
x_{25} : \text{Costo al producir en la planta 2, el producto 5 (ficticia).} \\
x_{31} : \text{Costo al producir en la planta 3, el producto 1.} \\ 
x_{32} : \text{Costo al producir en la planta 3, el producto 2.} \\ 
x_{33} : \text{Costo al producir en la planta 3, el producto 3.} \\ 
x_{34} : \text{Costo al producir en la planta 3, el producto 4.} \\
x_{35} : \text{Costo al producir en la planta 3, el producto 5 (ficticia).}
\end{array}
$$
**Modelo matemático completo.** En base a la definición anterior para las variables de decisión, y a la información entregada, matemáticamente el modelo de Programación Lineal a resolver es el siguiente: 
$$
\begin{array}{ll}
\min Z = \ \ 41x_{11} + \ \ 27x_{12} + 28x_{13} + 24x_{14} + 0x_{15} \\
\ \ \ \ \ \ \ \ \ \ + \ \ 40x_{21} + 29x_{22} + 0x_{23} + 23x_{24} + 0x_{25}   \\
 \ \ \ \ \ \ \ \ \ \ + 37x_{31} + \ \ 30x_{32} + 27x_{33} + 21x_{34} + 0x_{35}  \\
\text{S.A.} \\
\ \ \ \ \ \ \ \ \ \ \ x_{11} + x_{12} + x_{13} + x_{14} + x_{15} = 75 \ \text{(suministro planta 1).} \\     
\ \ \ \ \ \ \ \ \ \ \ x_{21} + x_{22} + x_{23} + x_{24} + x_{25} = 75 \ \text{(suministro planta 2).} \\    
\ \ \ \ \ \ \ \ \ \ \ x_{31} + x_{32} + x_{33} + x_{34} + x_{35} = 45 \ \text{(suministro planta 3).} \\    
\ \ \ \ \ \ \ \ \ \ \ x_{11} + x_{21} + x_{31} \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ = 20 \ \text{(demanda ciudad 1).} \\    
\ \ \ \ \ \ \ \ \ \ \ x_{12} + x_{22} + x_{32} \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ = 30 \ \text{(demanda ciudad 2).} \\    
\ \ \ \ \ \ \ \ \ \ \ x_{13} + x_{23} + x_{33} \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ = 30 \ \text{(demanda ciudad 3).} \\    
\ \ \ \ \ \ \ \ \ \ \ x_{14} + x_{24} + x_{34} \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ = 40 \ \text{(demanda ciudad 4).} \\ 
\ \ \ \ \ \ \ \ \ \ \ x_{15} + x_{25} + x_{35} \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ = \ \ 75 \ \text{(demanda ciudad ficticia 5).} \\
\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \  x_{ij} \geq \ \ 0 \ \text{(no negatividad de las variables).}
\end{array}
$$
**Transcribimos el modelo anterior a R.** 

* Matriz de costos
```{r}
cost_mat_1 <- matrix(c( 41,  27, 28, 24, 0,
                        40, 29, 0, 23, 0,
                       37,  30, 27, 21, 0), ncol = 5, byrow = TRUE)

cost_mat_1
```

* Direccion de las desigualdades de las restricciones para las filas (oferta)
```{r}
row_constr_signs_1 <- c("==", "==", "==")

row_constr_signs_1
```

* Coeficientes de las restricciones para las filas (oferta)
```{r}
row_rhs_1 <- c(75, 75 ,45)

row_rhs_1
```

* Direccion de las desigualdades de las restricciones para las columnas (demanda)
```{r}
col_constr_signs_1 <- c("==", "==", "==", "==", "==")

col_constr_signs_1
```

* Coeficientes de las restricciones para las columnas (demanda)
```{r}
col_rhs_1 <- c(20, 30, 30, 40, 75)

col_rhs_1
```

<br>

**Resolvemos.** 
```{r}
#install.packages("lpSolve")
library(lpSolve)

solucion_1 <- lp.transport(cost.mat = cost_mat_1,
                           direction = "min",
                           row.signs = row_constr_signs_1,
                           row.rhs = row_rhs_1,
                           col.signs = col_constr_signs_1,
                           col.rhs = col_rhs_1, 
                           presolve = 0)

solucion_1$solution
```

<br>
**Valores óptimos para las variables de decisión.** (Plan optimo de distribución)

* Costo al producir en la planta 1, el producto 2.  

$$x_{12} = 30$$

* Costo al producir en la planta 1, el producto 5 ficticio.  

$$x_{15} = 45$$

* Costo al producir en la planta 2, el producto 3.  

$$x_{23} = 30$$

* Costo al producir en la planta 2, el producto 4.  

$$x_{24} = 15$$

* Costo al producir en la planta 2, el producto 5.  

$$x_{25} = 30$$

* Costo al producir en la planta 3, el producto 1.  

$$x_{31} = 20$$

* Costo al producir en la planta 3, el producto 4.  

$$x_{34} = 25$$

<br>
**Costo mínimo asociado al plan de transporte.**
```{r}
solucion_1
```
El minimo costo que podemos producir es de 2420$ , tambien notamos que en la planta 1 y en la platan 2 sobran produciones 45 , 30 respectivamente debido a que tienen una capacidad disponible mayor a la que requerimos  

