---
title: "Solemne 1: Método Simplex, Método de la Gran M, Análisis de Sensibilidad usando lpSolve()"
subtitle: "*Investigación de Operaciones - ADVANCE - UNAB*"
author: "Marcelo Alid-Vaccarezza"
date: "`r Sys.Date()`"
output:
  html_notebook:
    toc: true
    toc_float: true
    toc_collapsed: true
    toc_depth: 3
    fig_caption: true
    number_sections: false
    theme: cosmo
---

<div style="text-align: justify">
<br>
<br>


```{r setup, include = FALSE}
knitr::opts_chunk$set(echo = FALSE)
knitr::opts_chunk$set(warning = FALSE)
```


# **Ejercicio 1.** 
Se fabrican dos aleaciones, $A$ y $B$, con cuatro metales $I$, $II$, $III$ y $IV$ de acuerdo con las siguientes especificaciones:

<br>
<center>

![**Figura 1:** Especificaciones](Figura_1_Problema_1_Solemne_1.png ""){height="300px" width="500px"}

</center>
<br>

A su vez, los cuatro metales son obtenidos a partir de tres minerales, de acuerdo con los siguientes datos:

<br>
<center>

![**Figura 2:** Componentes](Figura_2_Problema_1_Solemne_1.png ""){height="300px" width="500px"}

</center>
<br>

(a) Defina correctamente todas las variables de decisión. Sugerencia: sea $x_{ik}$ las toneladas del mineral $i$ asignadas a la aleación $k$, y defina $w_k$ como las toneladas producidas de la aleación $k$.  
(b) Escriba la funcion objetivo que optimiza la utilidad para la elaboración de las aleaciones.  
(c) Escriba las restricciones asociadas al problema.  
(d) Plantee matemáticamente el modelo completo asociado al problema.  
(e) Encuentre el plan óptimo de producción e interprete los resultados.  
(f) Encuentre el valor óptimo de la función objetivo de acuerdo al plan óptimo de producción obtenido e interprete los resultados.


<br>
$$
\begin{array}{ll}
x_1 : \text{Toneladas Metal I} \\  
x_2 : \text{{Toneladas Metal II} \\   
x_3 : \text{{Toneladas Metal III} \\
x_4 : \text{{Toneladas Metal IV} \\
x_5 : \text{{Toneladas Metal Otros} \\
\end{array}
$$
**(b) Función objetivo (utilidad).**

$$
\begin{array}{ll}
\max Z = 160x_1 + 210x_2 + 190x_3+210x_4 \\  
\end{array}
$$
**(c) Restricciones.**

$$
\begin{array}{ll}
20x_1 + 10x_2 + 30x_3 + 30x_4 + 10x_5 \leq 1000 \ \text{(Cantidad de mineral 1).} \\     
\ \ 10x_1 + 20x_2 +  30x_3 + 30x_4 + 10x_5 \leq 2000 \ \text{(Cantidad mineral 2 ).} \\  
\ \ 5x_1 + 5x_2 + 70x_3 + 20x_4 + 0x_5 \leq 3000 \ \text{(Cantidad de mineral 3).} \\   
\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ x_1, x_2, x_3, x_4, x_5 \geq \ \ \ \ 0 \ \text{(no negatividad de las variables).}
\end{array}
$$



**d) Modelo matemático completo.** El modelo matemático de programación lineal para la compañía queda de la siguiente manera: 

$$
\begin{array}{ll}
\max Z = 160x_1 + 210x_2 + 190x_3+210x_4 + 0x_5 \\ 
\text{S.A.} \\  
20x_1 + 10x_2 + 30x_3 + 30x_4 + 10x_5 \leq 1000 \ \text{(Cantidad de mineral 1).} \\     
\ \ 10x_1 + 20x_2 +  30x_3 + 30x_4 + 10x_5 \leq 2000 \ \text{(Cantidad mineral 2 ).} \\  
\ \ 5x_1 + 5x_2 + 70x_3 + 20x_4 + 0x_5 \leq 3000 \ \text{(Cantidad de mineral 3).} \\   
\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ x_1, x_2, x_3, x_4, x_5 \geq \ \ \ \ 0 \ \text{(no negatividad de las variables).}
\end{array}
$$
**(e) Transcribimos el modelo anterior a R.** 

* Coeficientes de la función objetivo. 
 
```{r}
C <- c(160, 210, 190, 210, 0)  
  
C  
```
* Matriz de coeficientes de las restricciones

```{r}
A <- matrix(c(20, 10, 30,30, 10,
               10, 20,  30, 30, 10,
               5, 5, 70, 20, 0 ), ncol = 5, byrow = TRUE)

A
```
* Direccion de las desigualdades de las restricciones

```{r}
D <- c("<=", "<=", "<=")

D
```
* Coeficientes lado derecho de las restricciones

```{r}
B <- c(1000, 2000, 3000)

B
```
**Plan optimo de produccion.** Resolvemos

```{r}
#install.packages("lpSolve")
library(lpSolve)

sol <- lp(direction = "max", 
          const.mat = A,
          const.rhs = B,
          objective.in = C, 
          const.dir = D,
          compute.sens = 1)
```

**Valores optimos para las variables de decision (incluidas las variables auxiliares de holgura).**

```{r}
sol$solution
```

<br>

# **Ejercicio 2.** 
Una fábrica de muebles produce pupitres unipersonales, bipersonales y mesas, para los cuales ha establecido que rinden una utilidad unitaria de $30$, $20$, y $50$ unidades monetarias. Para la producción de dichos artículos la compañía cuenta con una disponibilidad semanal de $4300$ metros de madera, $4600$ metros de tubo y $4200$ metros de fórmica. Se sabe que para producir un pupitre unipersonal se requieren un metro de madera, $3$ metros de tubo y un metro de fórmica, que para producir un pupitre bipersonal se requieren $2$ metros de madera y $4$ metros de formica; mientras que para producir una mesa se necesita un metro de madera y $2$ metros de tubo.

(a) Defina correctamente todas las variables de decisión.  
(b) Escriba la función objetivo que optimiza la utilidad para la elaboración de los productos.  
(c) Escriba las restricciones asociadas al problema.  
(d) Plantee matemáticamente el modelo completo asociado al problema.  
(e) Encuentre el plan óptimo de producción e interprete los resultados.  
(f) Encuentre el valor óptimo de la función objetivo de acuerdo al plan óptimo de producción obtenido e interprete los resultados.  
(g) Realice un análisis de sensibilidad completo.  
(h) Si la empresa pudiese incrementar la cantidad de materia prima a usar, ¿cuál tendrá la prioridad? Explique fundamentadamente.  
(i) Se sugiere aumentar la cantidad de madera y tubo al costo adicional de $15$$/m$ para cada una. ¿Es esto aconsejable? Explique fundamentadamente.  
(j) Si la cantidad de fórmica se reduce en $100$ metros, ¿cómo impactará este incremento al ingreso óptimo? Explique fundamentadamente.  
(k) Suponga que la disponibilidad de madera se incrementa en $200$ metros, ¿cómo afectará este incremento al ingreso óptimo? Explique fundamentadamente.  
(l) Suponga que los ingresos unitarios producidos para los productos $1$ y $2$ cambian a $60$ y $30$ unidades monetarias respectivamente, y de manera independiente. ¿Permanecerá igual el óptimo actual? Explique fundamentadamente y calcule el valor de la función objetivo en este nuevo escenario.

<br>
$$
\begin{array}{ll}
x_1 : \text{Cantidad de Pupitres unipersonales a producir por semana.} \\  
x_2 : \text{Cantidad de Pupitres bipersonales a producir por semana.} \\   
x_3 : \text{Cantidad de Mesas a producir por semana.}
\end{array}
$$
**(b) Función objetivo (utilidad).**

$$
\begin{array}{ll}
\max Z = 30x_1 + 20x_2 + 50x_3 \\  
\end{array}
$$
**(c) Restricciones.**

$$
\begin{array}{ll}
x_1 + 2x_2 + 1x_3 \leq 4300 \ \text{(metros de madera).} \\     
\ \ 3x_1 + 0x_2 + \ \ 2x_3 \leq 4600 \ \text{(metros de tubo).} \\  
\ \ 1x_1 + 4x_2 + 0x_3 \leq 4200 \ \text{(cantidad de fomila).} \\   
\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ x_1, x_2, x_3 \geq \ \ \ \ 0 \ \text{(no negatividad de las variables).}
\end{array}
$$



**d) Modelo matemático completo.** El modelo matemático de programación lineal para la compañía queda de la siguiente manera: 

$$
\begin{array}{ll}
\max Z = 30x_1 + 20x_2 + 50x_3 \\  
\text{S.A.} \\  
x_1 + 2x_2 + 1x_3 \leq 4300 \ \text{(metros de madera).} \\     
\ \ 3x_1 + 0x_2 + \ \ 2x_3 \leq 4600 \ \text{(metros de tubo).} \\  
\ \ 1x_1 + 4x_2 + 0x_3 \leq 4200 \ \text{(cantidad de fomila).} \\   
\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ x_1, x_2, x_3 \geq \ \ \ \ 0 \ \text{(no negatividad de las variables).}
\end{array}
$$

* Coeficientes de la función objetivo. 
 
```{r}
C <- c(30, 20, 50)  
  
C  
```

* Matriz de coeficientes de las restricciones

```{r}
A <- matrix(c(1, 2, 1,
               3, 0,  2,
               1, 4, 0), ncol = 3, byrow = TRUE)

A
```

* Direccion de las desigualdades de las restricciones

```{r}
D <- c("<=", "<=", "<=")

D
```
* Coeficientes lado derecho de las restricciones

```{r}
B <- c(4300, 4600, 4200)

B
```
**Plan optimo de produccion.** Resolvemos

```{r}
#install.packages("lpSolve")
library(lpSolve)

sol <- lp(direction = "max", 
          const.mat = A,
          const.rhs = B,
          objective.in = C, 
          const.dir = D,
          compute.sens = 1)
```


**Valores optimos para las variables de decision (incluidas las variables auxiliares de holgura).**

```{r}
sol$solution
```


* Pupitres Unipersonales a producir por semana:  

$$x_1 = 0$$

* Pupitres Bipersonales a producir por semana:  

$$x_2 = 1000$$

* Mesas a producir por semana:  

$$x_3 = 2300$$
* Holgura primera restricción: 

```{r}
1*sol$solution[1] + 2*sol$solution[2] + 1*sol$solution[3]
```

Se utilizan los 4300 metros de Madera, por lo tanto la primera variable de holgura es:

$$S_1 = 0$$

* Holgura segunda restricción:

```{r}
3*sol$solution[1] + 0*sol$solution[2] + 2*sol$solution[3]
```
Se utilizan los 4600 metros de tubo, por lo tanto la primera variable de holgura es:

$$S_2 = 0$$
* Holgura tercera restriccion:

```{r}
1*sol$solution[1] + 4*sol$solution[2] + 0*sol$solution[3]
```

Se utilizan $4000$ formila, por lo tanto la tercera variable de holgura es:

$$S_3 = 4200 - 4000 = 200$$ 
**(f) Valor optimo de la funcion objetivo.** La utilidad óptima que obtendrá la compañia al producir según el plan óptimo de producción encontrado es:

```{r}
sol
```
Es decir, se obtienen $Z^* = 135000$ unidades monetarias de utilidad.

**(g.1) Analisis de sensibilidad para los coeficientes de recursos (lado derecho de las restricciones, $b_i$).** El incremento/decremento de una unidad en $b_i$, produce un aumento/disminucion en $Z^*$ igual al precio sombra $Y_i$. En efecto: $$Z'^* = Z^* \pm Y_i$$

```{r}
sol$duals[1:3]
```
* Aumento/decremento de $Z^*$ si $b_1$ aumenta/decrece en una unidad. 

$$Y_1 = 10$$

* Aumento/decremento de $Z^*$ si $b_2$ aumenta/decrece en una unidad.  

$$Y_2 = 20$$

* Aumento/decremento de $Z^*$ si $b_3$ aumenta/decrece en una unidad.  

$$Y_3 = 0$$
**(g.2) Analisis de sensibilidad para coeficientes de la funcion objetivo.** El plan de produccion optimo $X^*$ no cambia, pero si cambia $Z^*$ ya que cambian los coeficientes $c_j$.

```{r}
#install.packages("tibble")
library(tibble)
tibble(c = c("c1", "c2", "c3"),
       min = sol$sens.coef.from,
       max = sol$sens.coef.to)
```
* Los intervalos para los coeficientes $c_j$ son (los costos unitario de las actividades pueden cambiar en estos intervalo sin que se modifique el plan optimo de produccion):  

$$
\begin{array}{ll}
-\infty \leq c_1 \leq 70 \\ 
\ \ \ 0  \leq c_2 \leq 100 \\  
\ \ \ 23  \leq c_3 \leq \infty
\end{array}
$$
**(g.3) Analisis de sensibilidad para los coeficientes $b_i$.** Interesa encontrar los intervalos $b_{i,min} \leq b_i \leq b_{i,max}$ para los $b_i$ en los cuales el precio sombra $Y_i$ sigue siendo valido. El plan de produccion optimo $X^*$ cambia y tambien cambia $Z^*$. 

Para calcular estos intervalos es necesario resolver el problema dual

```{r}
A_dual <- t(A)

B_dual <- C

C_dual <- B

D_dual <- c(">=", ">=", ">=")

sol_dual <- lp(direction = "min", 
               const.mat = A_dual,
               const.rhs = B_dual,
               objective.in = C_dual, 
               const.dir = D_dual,
               compute.sens = 1)
```
y extraer el intervalo de sensibilidad para los coeficientes $c'_{j}$ del problema dual. Dado que estos corresponden a los coeficientes $b_{i}$ en el problema primal, tendremos entonces los intervalos buscados. En efecto:

```{r}
tibble(b = c("b1", "b2", "b3"), 
       min = sol_dual$sens.coef.from,
       max = sol_dual$sens.coef.to)
```
Así, finalmente los intervalos $b_{i,min} \leq b_i \leq b_{i,max}$ para los coeficientes $b_i$ quedan como se presentan a continuación:

$$
\begin{array}{ll}
\ \ \ \ 2300 \leq b_1 \leq 4400  \\
\ \ 4400 \leq b_2 \leq \leq 8600 \\   
4000 \leq b_3 \leq \ \ \infty
\end{array}
$$
**(h)** Según los precios sombra para las materias primas $1$, $2$ y $3$, cada metro adicional de madera aumenta el ingreso en $10$, en comparación con $20$ para la tubo y $0$ para los formica Por lo tanto, el Tubo deben tener la prioridad que genera mayor utilidad.

**(i)** Para la madera, el ingreso neto adicional por metro es $\$10 - \$15 = -\$5$ estariamos perdiendo utilidades, y para los tubos, es $\$20 - \$15 = \$5$. Por consiguiente, Solo debe aumentar los metros de tubo para mayor utilidad

**(j)** El precio sombra para la disponibilidad de formica es $\$0$ y es válido en el intervalo ($4000$, $\infty$)metros. La disminución propuesta de $100$ metros no nos procuparia ya que nos soban 200 metros de formica por no tendremos variciones en la utilidad   

**(l)** Si los valores de los productos se ven modificados a 60 y 30 estos valores se encuentre entre  los intervalos c1 $-infinito,70$ y para c2 $0, 100$ por esto la ecuacion anteriormente calculada nos sigue sirviendo  Los valores se mantendran solo aumentara la utilidad debido a que el producto 2 aumento su precio, recalcularemos de todas maneras 



* Coeficientes de la función objetivo. 
 
```{r}
C <- c(60, 30,50)  
  
C  
```
**Plan optimo de produccion.** Resolvemos

```{r}
#install.packages("lpSolve")
library(lpSolve)

sol <- lp(direction = "max", 
          const.mat = A,
          const.rhs = B,
          objective.in = C, 
          const.dir = D,
          compute.sens = 1)
```

**Valor optimo de la funcion objetivo.** La utilidad óptima que obtendrá la compañia al producir según el plan óptimo de producción encontrado es:

```{r}
sol
```
**Nuestra utilidad aumento 10000 con los nuevos precios de venta**

**(k)** El aumento propuesto es de $200$ ya que $4300 + 200 = 4500$ el cual no se encuentra en el intervalo de factibilidad ($2300$, $4400$)metros, por lo que los precios sombra cambian. Esto significa que con la información disponible no es posible dar una respuesta de como cambia el ingreso óptimo con este cambio de escenario, por lo que habría que resolver desde cero el nuevo problema, con los nuevos valores por esto recalculamos 

**Modelo matemático completo.** El modelo matemático de programación lineal para la compañía queda de la siguiente manera: 

$$
\begin{array}{ll}
\max Z = 30x_1 + 20x_2 + 50x_3 \\  
\text{S.A.} \\  
x_1 + 2x_2 + 1x_3 \leq 4500 \ \text{(metros de madera).} \\     
\ \ 3x_1 + 0x_2 + \ \ 2x_3 \leq 4600 \ \text{(metros de tubo).} \\  
\ \ 1x_1 + 4x_2 + 0x_3 \leq 4200 \ \text{(cantidad de fomila).} \\   
\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ x_1, x_2, x_3 \geq \ \ \ \ 0 \ \text{(no negatividad de las variables).}
\end{array}
$$

* Coeficientes de la función objetivo. 
 
```{r}
C <- c(30, 20, 50)  
  
C  
```

* Matriz de coeficientes de las restricciones

```{r}
A <- matrix(c(1, 2, 1,
               3, 0,  2,
               1, 4, 0), ncol = 3, byrow = TRUE)

A
```

* Direccion de las desigualdades de las restricciones

```{r}
D <- c("<=", "<=", "<=")

D
```
* Coeficientes lado derecho de las restricciones

```{r}
B <- c(4500, 4600, 4200)

B
```
**Plan optimo de produccion.** Resolvemos

```{r}
#install.packages("lpSolve")
library(lpSolve)

sol <- lp(direction = "max", 
          const.mat = A,
          const.rhs = B,
          objective.in = C, 
          const.dir = D,
          compute.sens = 1)
```


**Valores optimos para las variables de decision (incluidas las variables auxiliares de holgura).**

```{r}
sol$solution
```

**Valor optimo de la funcion objetivo.** La utilidad óptima que obtendrá la compañia al producir según el plan óptimo de producción encontrado es:

```{r}
sol
```
**Como vemos los valores cambiaron ya que ahora necesitaremos realizar 50 pupitres bipersonales más que la ves anterior y aumentaremos nuestra utilidad en 1000 unidades monetarias. ** 

<br>

# **Ejercicio 3.** 
Una empresa fabrica dos productos en dos máquinas. Una unidad del producto $1$ requiere $4$ horas en la máquina $1$, y $2$ hora en la máquina $2$. Una unidad del producto $2$ requiere $2$ hora en la máquina $1$, y $6$ horas en la máquina $2$. Los ingresos por unidad de los productos $1$ y $2$ son de $\$60$ y $\$40$, respectivamente. El tiempo de procesamiento diario total disponible en cada máquina es de $16$ horas. Responda las siguientes preguntas.

(a) Defina correctamente todas las variables de decisión.  
(b) Escriba la funcion objetivo que optimiza la utilidad para la elaboración de los productos.  
(c) Escriba las restricciones asociadas al problema.  
(d) Plantee matemáticamente el modelo completo asociado al problema.  
(e) Encuentre el plan óptimo de producción e interprete los resultados.  
(f) Encuentre el valor óptimo de la función objetivo de acuerdo al plan óptimo de producción obtenido e interprete los resultados.  
(g) Realice un análisis de sensibilidad completo.  
(h) Si la empresa puede incrementar la capacidad de ambas máquinas, ¿cuál máquina tendrá la prioridad? Explique fundamentadamente.  
(i) Se sugiere incrementar las capacidades de las máquinas $1$ y $2$ al costo adicional de $\$20/h$ para cada máquina. ¿Es esto aconsejable? Explique fundamentadamente.  
(j) Si la capacidad de la máquina $1$ se incrementa de $16$ a $26$ horas, ¿cómo impactará este incremento al ingreso óptimo? Explique fundamentadamente.  
(k) Suponga que la capacidad de la máquina $1$ se incrementa a $40$ horas, ¿cómo afectará este incremento al ingreso óptimo? Explique fundamentadamente.  
(l) Suponga que los ingresos unitarios producidos para los productos $1$ y $2$ cambian a $\$70$ y $\$50$, respectivamente, y de manera independiente. ¿Permanecerá igual el óptimo actual? Explique fundamentadamente y calcule el valor de la función objetivo en este nuevo escenario.

$$
\begin{array}{ll}
x_1 : \text{Cantidad de Productos 1 a producir por dia} \\  
x_2 : \text{Cantidad de Productos 2 a producir por dia} 
\end{array}
$$
**(b) Función objetivo (utilidad).**

$$
\begin{array}{ll}
\max Z = 60x_1 + 40x_2  \\  
\end{array}
$$
**(c) Restricciones.**

$$
\begin{array}{ll}
4x_1 + 2x_2  \leq 16 \ \text{(hrs maquina 1).} \\     
\ \ 2x_1 + 6x_2  \leq 16 \ \text{(hrs maquina 2).} \\  
\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ x_1, x_2\geq \ \ \ \ 0 \ \text{(no negatividad de las variables).}
\end{array}
$$



**d) Modelo matemático completo.** El modelo matemático de programación lineal para la compañía queda de la siguiente manera: 

$$
\begin{array}{ll}
\max Z = 60x_1 + 40x_2x \\  
\text{S.A.} \\  
4x_1 + 2x_2 \leq 16 \ \text{(hrs maquina 1).} \\     
\ \ 2x_1 + 6x_2  \leq 16 \ \text{(hrs maquina 2).} \\  
\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ x_1, x_2\geq \ \ \ \ 0 \ \text{(no negatividad de las variables).}
\end{array}
$$
* Coeficientes de la función objetivo. 
 
```{r}
C <- c(60, 40)  
  
C  
```
* Matriz de coeficientes de las restricciones

```{r}
A <- matrix(c(4, 2,
               2, 6), ncol = 2, byrow = TRUE)

A
```
* Direccion de las desigualdades de las restricciones

```{r}
D <- c("<=", "<=")

D
```
* Coeficientes lado derecho de las restricciones

```{r}
B <- c(16, 16)

B
```
**Plan optimo de produccion.** Resolvemos

```{r}
#install.packages("lpSolve")
library(lpSolve)

sol <- lp(direction = "max", 
          const.mat = A,
          const.rhs = B,
          objective.in = C, 
          const.dir = D,
          compute.sens = 1)
```

**Valores optimos para las variables de decision (incluidas las variables auxiliares de holgura).**

```{r}
sol$solution
```
* Productos 1 a producir por semana:  

$$x_1 = 3.2$$

* productos 2 a producir por semana:  

$$x_2 = 1.6$$
* Holgura primera restricción: 

```{r}
4*sol$solution[1] + 2*sol$solution[2] 
```

Se utilizan la 16 hrs de la maquina 1 por lo tanto la primera variable de holgura es:

$$S_1 = 0$$

* Holgura segunda restricción:

```{r}
2*sol$solution[1] + 6*sol$solution[2] 
```
Se utilizan las 16 hrs de la maquina 2 por lo tanto la segunda variable de holgura es:

$$S_2 = 0$$
**(f) Valor optimo de la funcion objetivo.** La utilidad óptima que obtendrá la compañia al producir según el plan óptimo de producción encontrado es:

```{r}
sol
```
Es decir, se obtienen $Z^* = 135000$ unidades monetarias de utilidad.

**(g.1) Analisis de sensibilidad para los coeficientes de recursos (lado derecho de las restricciones, $b_i$).** El incremento/decremento de una unidad en $b_i$, produce un aumento/disminucion en $Z^*$ igual al precio sombra $Y_i$. En efecto: $$Z'^* = Z^* \pm Y_i$$

```{r}
sol$duals[1:2]
```
* Aumento/decremento de $Z^*$ si $b_1$ aumenta/decrece en una unidad. 

$$Y_1 = 14$$

* Aumento/decremento de $Z^*$ si $b_2$ aumenta/decrece en una unidad.  

$$Y_2 = 2$$
**(g.2) Analisis de sensibilidad para coeficientes de la funcion objetivo.** El plan de produccion optimo $X^*$ no cambia, pero si cambia $Z^*$ ya que cambian los coeficientes $c_j$.

```{r}
#install.packages("tibble")
library(tibble)
tibble(c = c("c1", "c2"),
       min = sol$sens.coef.from,
       max = sol$sens.coef.to)
```
* Los intervalos para los coeficientes $c_j$ son (los costos unitario de las actividades pueden cambiar en estos intervalo sin que se modifique el plan optimo de produccion):  

$$
\begin{array}{ll}
13.3 \leq c_1 \leq 80 \\ 
\ \ \ 30  \leq c_2 \leq 180 
\end{array}
$$
**(g.3) Analisis de sensibilidad para los coeficientes $b_i$.** Interesa encontrar los intervalos $b_{i,min} \leq b_i \leq b_{i,max}$ para los $b_i$ en los cuales el precio sombra $Y_i$ sigue siendo valido. El plan de produccion optimo $X^*$ cambia y tambien cambia $Z^*$. 

Para calcular estos intervalos es necesario resolver el problema dual

```{r}
A_dual <- t(A)

B_dual <- C

C_dual <- B

D_dual <- c(">=", ">=")

sol_dual <- lp(direction = "min", 
               const.mat = A_dual,
               const.rhs = B_dual,
               objective.in = C_dual, 
               const.dir = D_dual,
               compute.sens = 1)
```
y extraer el intervalo de sensibilidad para los coeficientes $c'_{j}$ del problema dual. Dado que estos corresponden a los coeficientes $b_{i}$ en el problema primal, tendremos entonces los intervalos buscados. En efecto:

```{r}
tibble(b = c("b1", "b2"), 
       min = sol_dual$sens.coef.from,
       max = sol_dual$sens.coef.to)
```
Así, finalmente los intervalos $b_{i,min} \leq b_i \leq b_{i,max}$ para los coeficientes $b_i$ quedan como se presentan a continuación:

$$
\begin{array}{ll}
\ \ \ \ 5.3 \leq b_1 \leq 32  \\
\ \ 8 \leq b_2 \leq \leq 48 \\   
\end{array}
$$
**(h)** Según los precios sombra para las maquinas $1$ y $2$, cada hra adicional de maquina 1 aumenta el ingreso en $14$, en comparación con $2$ para la maquina 2 Por lo tanto, deberiamos aumentar las hrs de la maquina 1 por prioridad.

**(i)** si aumenta la capicidad el costo adicional es mayor a nuestro utilidad por maquina, maquina 1 $14-20= -6$ y maquina 2 $2-20= -18$ por esto no nos sale rentable ya que perdiriamos utilidades 

**(j)** las 26 hrs, queda entre nuestro intervalo que va entre ($5.3$, $32$) por esto aumentara nuestro ingreso optimo en $26-16 = 10 hrs$ en 10 hrs mas por la maquina 1 tendra un aumento de utilidad en $10 * 14= 140$ aumentando de $256+140= 396$ nuestra utilidad 

**(l)** si aumentan los ingresos estos quedan dentro de los intervalos de utilidad maquina 1 $13.3, 80$ y maquina 2 $30,180$  por esto nuestros calculos no cambiaran simplente aumentara la utilidad recalcularemos 

* Coeficientes de la función objetivo. 
 
```{r}
C <- c(70, 50)  
  
C  
```
**Plan optimo de produccion.** Resolvemos

```{r}
#install.packages("lpSolve")
library(lpSolve)

sol <- lp(direction = "max", 
          const.mat = A,
          const.rhs = B,
          objective.in = C, 
          const.dir = D,
          compute.sens = 1)
```

**Valor optimo de la funcion objetivo.** La utilidad óptima que obtendrá la compañia al producir según el plan óptimo de producción encontrado es:

```{r}
sol
```
**(k)** El aumento propuesto de aumento a 40 hrs maquina 1 no queda dentro de los intervalos por eso tendremos que recalcular los valores para obtener una respuesta por esto lo recalcularemos 

**Modelo matemático completo.** El modelo matemático de programación lineal para la compañía queda de la siguiente manera: 

$$
\begin{array}{ll}
\max Z = 60x_1 + 40x_2x \\  
\text{S.A.} \\  
4x_1 + 2x_2 \leq 40 \ \text{(hrs maquina 1).} \\     
\ \ 2x_1 + 6x_2  \leq 16 \ \text{(hrs maquina 2).} \\  
\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ x_1, x_2\geq \ \ \ \ 0 \ \text{(no negatividad de las variables).}
\end{array}
$$
* Coeficientes de la función objetivo. 
 
```{r}
C <- c(60, 40)  
  
C  
```
* Matriz de coeficientes de las restricciones

```{r}
A <- matrix(c(4, 2,
               2, 6), ncol = 2, byrow = TRUE)

A
```
* Direccion de las desigualdades de las restricciones

```{r}
D <- c("<=", "<=")

D
```
* Coeficientes lado derecho de las restricciones

```{r}
B <- c(40, 16)

B
```
**Plan optimo de produccion.** Resolvemos

```{r}
#install.packages("lpSolve")
library(lpSolve)

sol <- lp(direction = "max", 
          const.mat = A,
          const.rhs = B,
          objective.in = C, 
          const.dir = D,
          compute.sens = 1)
```

**Valores optimos para las variables de decision (incluidas las variables auxiliares de holgura).**

```{r}
sol$solution
```

**Valor optimo de la funcion objetivo.** La utilidad óptima que obtendrá la compañia al producir según el plan óptimo de producción encontrado es:

```{r}
sol
```
**Como podemos ver nuestro ingreso optimo aumento y tambien solo realizaremos 8 productos 1 esto nos brindara una utilidad optima de 480$**
